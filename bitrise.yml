---
format_version: '8'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: other
trigger_map:
- push_branch: "*"
  workflow: primary
- pull_request_source_branch: "*"
  workflow: primary
workflows:
  primary:
    steps:
    - git-clone@8.0.0: {}
    - script@1.2.0:
        title: Install Cocoapods
        inputs:
        - content: |
            #!/usr/bin/env bash

            sudo gem install cocoapods
    - script@1.1.4:
        title: brew cask install docker-toolbox
        inputs:
        - content: |-
            #!/bin/bash
            set -ex

            brew cask install docker-toolbox
    - script@1.1.4:
        title: docker-machine create
        inputs:
        - content: |-
            #!/bin/bash
            set -ex

            docker-machine create --driver "virtualbox" default
    - script@1.2.0:
        title: Run local petstore server via docker
        inputs:
        - content: |
            #!/usr/bin/env bash

            set -ex

            eval $(docker-machine env default)

            docker pull swaggerapi/petstore

            docker run -d -e SWAGGER_HOST=http://petstore.swagger.io -e SWAGGER_BASE_PATH=/v2 -p 80:8080 swaggerapi/petstore
    - script@1.2.0:
        title: Run Swift6 tests
        inputs:
        - content: |
            #!/usr/bin/env bash

            set -e

            ./samples/client/petstore/swift6/swift6_test_all.sh
    - script@1.2.0:
        title: Run Swift5 tests
        inputs:
        - content: |
            #!/usr/bin/env bash

            set -e

            ./samples/client/petstore/swift5/swift5_test_all.sh
    - script@1.2.0:
        title: Run swift-combine tests
        inputs:
        - content: |
            #!/usr/bin/env bash

            set -e

            ./samples/client/petstore/swift-combine/swift-combine_test_all.sh

meta:
  bitrise.io:
    stack: osx-xcode-16.3.x
