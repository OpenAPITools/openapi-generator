/**
 *
 * Please note:
 * This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * Do not edit this file manually.
 *
 */

@file:Suppress(
    "ArrayInDataClass",
    "EnumEntryName",
    "RemoveRedundantQualifierName",
    "UnusedImport"
)

package org.openapitools.client.models

import org.openapitools.client.models.Bird
import org.openapitools.client.models.Robobird

import kotlinx.serialization.Serializable
import kotlinx.serialization.SerialName
import kotlinx.serialization.Contextual
import kotlinx.serialization.KSerializer
import kotlinx.serialization.Serializer
import kotlinx.serialization.builtins.serializer
import kotlinx.serialization.encoding.Decoder
import kotlinx.serialization.encoding.Encoder
import kotlinx.serialization.SerializationException
import kotlinx.serialization.descriptors.SerialDescriptor
import kotlinx.serialization.descriptors.buildClassSerialDescriptor
import kotlinx.serialization.json.JsonDecoder
import kotlinx.serialization.json.JsonEncoder
import kotlinx.serialization.json.JsonObject
import kotlinx.serialization.json.JsonPrimitive
import kotlinx.serialization.json.jsonObject
import kotlinx.serialization.json.jsonPrimitive

/**
 * 
 *
 */
@Serializable(with = AnimalSerializer::class)
sealed interface Animal {
    @JvmInline
     value class BirdWrapper(val value: Bird) : Animal

    @JvmInline
     value class RobobirdWrapper(val value: Robobird) : Animal

}

object AnimalSerializer : KSerializer<Animal> {
    override val descriptor: SerialDescriptor = buildClassSerialDescriptor("Animal")

    override fun serialize(encoder: Encoder, value: Animal) {
        require(encoder is JsonEncoder)
        val jsonObject = when (value) {
            is Animal.BirdWrapper -> {
                val jsonMap = encoder.json.encodeToJsonElement(Bird.serializer(), value.value).jsonObject.toMutableMap()
                jsonMap["discriminator"] = JsonPrimitive("BIRD")
                JsonObject(jsonMap)
            }
            is Animal.RobobirdWrapper -> {
                val jsonMap = encoder.json.encodeToJsonElement(Robobird.serializer(), value.value).jsonObject.toMutableMap()
                jsonMap["discriminator"] = JsonPrimitive("ROBOBIRD")
                JsonObject(jsonMap)
            }
        }
        encoder.encodeJsonElement(jsonObject)
    }

    override fun deserialize(decoder: Decoder): Animal {
        require(decoder is JsonDecoder)
        val element = decoder.decodeJsonElement().jsonObject

        val discriminatorValue = element["discriminator"]?.jsonPrimitive?.content
            ?: throw SerializationException("Missing discriminator field")

        return when (discriminatorValue) {
            "BIRD" -> {
                val decoded = decoder.json.decodeFromJsonElement(Bird.serializer(), element)
                Animal.BirdWrapper(decoded)
            }
            "ROBOBIRD" -> {
                val decoded = decoder.json.decodeFromJsonElement(Robobird.serializer(), element)
                Animal.RobobirdWrapper(decoded)
            }
            else -> throw SerializationException("Unknown Animal discriminator: $discriminatorValue")
        }
    }
}

