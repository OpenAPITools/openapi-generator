dist: trusty
sudo: required
language: java
Eaddons:
  apt:
    packages:
      - openjdk-6-jdk
jdk: openjdk6

cache:
  directories:
  - $HOME/.m2
  - $HOME/.ivy2
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
  - $HOME/samples/client/petstore/javascript/node_modules
  - $HOME/samples/client/petstore/php/OpenAPIToolsClient-php/vendor
  - $HOME/samples/client/petstore/ruby/vendor/bundle
  - $HOME/samples/client/petstore/python/.venv/
  - $HOME/samples/client/petstore/typescript-node/npm/node_modules
  - $HOME/samples/client/petstore/typescript-node/npm/typings/
  - $HOME/samples/client/petstore/typescript-fetch/tests/default/node_modules
  - $HOME/samples/client/petstore/typescript-fetch/tests/default/typings
  - $HOME/samples/client/petstore/typescript-fetch/builds/default/node_modules
  - $HOME/samples/client/petstore/typescript-fetch/builds/default/typings
  - $HOME/samples/client/petstore/typescript-fetch/builds/es6-target/node_modules
  - $HOME/samples/client/petstore/typescript-fetch/builds/es6-target/typings
  - $HOME/samples/client/petstore/typescript-fetch/builds/with-npm-version/node_modules
  - $HOME/samples/client/petstore/typescript-fetch/npm/with-npm-version/typings
  - $HOME/samples/client/petstore/typescript-angular/node_modules
  - $HOME/samples/client/petstore/typescript-angular/typings
  - $HOME/samples/server/petstore/rust-server/target
  - $HOME/perl5
  - $HOME/.cargo
  - $HOME/.stack

services:
  - docker

before_install:
  # show host table to confirm petstore.swagger.io is mapped to localhost
  - cat /etc/hosts

install:
  - ls $HOME

script:
  # fail fast
  #- set -e
  - jdk_switcher use openjdk6 
  - java -version
  - which java
  - export JAVA_HOME=/usr/lib/jvm/java-6-openjdk-amd64
  - ls /usr/lib/jvm/
  - ls /usr/lib/jvm/java-6-openjdk-amd64/
  - ls /usr/lib/jvm/java-6-openjdk-amd64/bin
  - export M2_HOME=$HOME/apache-maven-3.2.5
  - wget http://www.us.apache.org/dist/maven/maven-3/3.2.5/binaries/apache-maven-3.2.5-bin.tar.gz
  - tar zxvf apache-maven-3.2.5-bin.tar.gz -C $HOME
  - ls $HOME/apache-maven-3.2.5/bin/
  - $HOME/apache-maven-3.2.5/bin/mvn -version
  #- mvn --quiet clean install
  #- mvn --quiet verify -Psamples/client/petstore/java/jersey2-java6
  #- ./mvnw -f samples/client/petstore/java/jersey2-java6 test
  - cd samples/client/petstore/java/jersey2-java6 && $HOME/apache-maven-3.2.5/bin/mvn test

env:
  - DOCKER_GENERATOR_IMAGE_NAME=openapitools/openapi-generator-online DOCKER_CODEGEN_CLI_IMAGE_NAME=openapitools/openapi-generator-cli NODE_ENV=test
