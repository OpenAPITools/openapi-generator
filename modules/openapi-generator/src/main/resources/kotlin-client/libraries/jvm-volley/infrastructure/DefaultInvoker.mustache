package {{packageName}}.infrastructure

import android.content.Context
import com.android.volley.RequestQueue
import com.android.volley.toolbox.HurlStack
import java.net.HttpURLConnection
import java.net.URL
import java.net.URLEncoder
import javax.net.ssl.HttpsURLConnection

class DefaultInvoker(val context: Context) {

    fun escapeString(str: String): String {
        return try {
            URLEncoder.encode(str, "UTF-8")
        } catch (e: UnsupportedEncodingException) {
            str
        }
    }

    private val requestQueue: RequestQueue by lazy {
        val stack = object : HurlStack() {
            override fun createConnection(url: URL?): HttpURLConnection {
                val httpsURLConnection =
                    super.createConnection(url) as HttpsURLConnection
                try {
                    httpsURLConnection.sslSocketFactory = getSSLSocketFactory()
                    httpsURLConnection.hostnameVerifier = getHostnameVerifier()
                } catch (e: Exception) {
                    throw e
                }
                return httpsURLConnection
            }
        }
        Volley.newRequestQueue(context, stack)
    }

}