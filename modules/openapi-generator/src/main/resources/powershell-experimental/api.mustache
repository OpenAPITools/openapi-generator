{{> partial_header}}
{{#operations}}
{{#operation}}
function Invoke-{{{classname}}}{{{operationId}}} {
    [CmdletBinding()]
    Param (
    {{#allParams}}
        [Parameter(Position = {{vendorExtensions.x-index}}, ValueFromPipeline = $true, ValueFromPipelineByPropertyName = $true, Mandatory = {{#required}}$true{{/required}}{{^required}}$false{{/required}})]
        [{{^isContainer}}{{^isPrimitiveType}}{{^isFile}}{{{packageName}}}.Model.{{/isFile}}{{/isPrimitiveType}}{{/isContainer}}{{{dataType}}}]
        {{=<% %>=}}
        ${<%paramName%>}<%^-last%>,<%/-last%>
        <%={{ }}=%>
    {{/allParams}}
    )

    Process {
        'Calling method: {{{classname}}}-{{{operationId}}}' | Write-Host
        $PSBoundParameters | Out-DebugParameter | Write-Debug

        $LocalVarAccepts = @{}
        $LocalVarContentTypes = @{}
        $LocalVarHeaders = @{}
        $LocalVarQueryParameters = @{}
        $LocalVarFormParameters = @{}
        $LocalVarBodyParameters = @{}
        $LocalVarPathParameters = @{}

        $Configuraiton = Get-OpenAPIConfiguration

        $LocalVarUri = '{{{basePath}}}'
        {{=< >=}}
        <#pathParams>
        $LocalVarUri = $LocalVarUri.replace('{<baseName>}', $<paramName>)
        </pathParams>
        <={{ }}=>
        $LocalVarUri = $Configuration["BaseUrl"] + $LocalVarUri

        {{#headerParams}}
        {{#required}}
        {{^isNullable}}
        if (!${{{paramName}}}) {
            throw "Error! ${{{paramName}}} is required."
        }

        {{/isNullable}}
        {{/required}}
        $LocalVarHeaderParameters['{{baseName}}'] = ${{{paramName}}}

        {{/headerParams}}
        {{#queryParams}}
        {{#required}}
        {{^isNullable}}
        if (!${{{paramName}}}) {
            throw "Error! ${{{paramName}}} is required."
        }

        {{/isNullable}}
        {{/required}}
        $LocalVarQueryParameters['{{baseName}}'] = ${{{paramName}}}

        {{/queryParams}}
        {{#formParams}}
        {{#required}}
        {{^isNullable}}
        if (!${{{paramName}}}) {
            throw "Error! ${{{paramName}}} is required."
        }

        {{/isNullable}}
        {{/required}}
        $LocalVarFormParameters['{{baseName}}'] = ${{{paramName}}}

        {{/formParams}}


        Invoke-OpenAPIAPIClient -Method '{{httpMethod}}' `
                                -Uri $LocalVarUri `
                                -Accept $LocalVarAccepts `
                                -ContentType $LocalVarContentTypes `
                                -Body $LocalVarBodyParameters `
                                -HeaderParameters LocalVarHeaderParameters `
                                -QueryParameters LocalVarQueryParameters `
                                -FormParameters LocalVarFormParameters

        #$Script:{{{classname}}}.{{{operationId}}}(
        #{{#allParams}}
        #    {{=<% %>=}}
        #    ${<%paramName%>}<%^-last%>,<%/-last%>
        #    <%={{ }}=%>
        #{{/allParams}}
        #)
    }
}

{{/operation}}
{{/operations}}
