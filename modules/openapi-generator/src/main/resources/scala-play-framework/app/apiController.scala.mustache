package {{package}}

import javax.inject.{Inject, Singleton}
import play.api.libs.json._
import play.api.mvc._{{#apiFutures}}
import scala.concurrent.{ExecutionContext, Future}{{/apiFutures}}{{#imports}}
import {{import}}{{/imports}}
{{#operations}}

{{>generatedAnnotation}}@Singleton
class {{classname}}Controller @Inject()(cc: ControllerComponents, api: {{classname}}){{#apiFutures}}(implicit executionContext: ExecutionContext){{/apiFutures}} extends AbstractController(cc) {
  {{#operation}}
  /**
    * {{httpMethod}} {{path}}{{#queryParams.0}}?{{/queryParams.0}}{{#queryParams}}{{paramName}}=[value]{{#hasMore}}&{{/hasMore}}{{/queryParams}} {{#pathParams}}{{#description}}
    * @param {{paramName}} {{description}}{{/description}}{{/pathParams}}
    */
  def {{operationId}}({{#pathParams}}{{paramName}}: {{dataType}}{{#hasMore}}, {{/hasMore}}{{/pathParams}}): Action[AnyContent] = Action{{#apiFutures}}.async{{/apiFutures}} { request =>
    {{! Keep the execution result in its own block to prevent redeclaration of parameter names (however unlikely that might be). }}
    def executeApi(): {{>returnTypeOrUnit}} = {
      {{#bodyParams}}
      val {{paramName}} = request.body.asJson.map(_.as[{{dataType}}]){{#required}}.getOrElse {
        throw new IllegalArgumentException("Missing required body parameter.")
      }{{/required}}
      {{/bodyParams}}
      {{#headerParams}}
      val {{paramName}} = request.headers.get("{{baseName}}"){{^isString}}.map(value => {{>convertHeaderParam}}){{/isString}}{{#required}}.getOrElse {
        throw new IllegalArgumentException("Missing header `{{baseName}}`.")
      }{{/required}}
      {{/headerParams}}
      {{#queryParams}}
      val {{paramName}}: {{>dataTypeOption}} = null // TODO [query]
      {{/queryParams}}
      {{#formParams}}
      val {{paramName}}: {{>dataTypeOption}} = null // TODO [form]
      {{/formParams}}
      api.{{operationId}}({{#allParams}}{{paramName}}{{#hasMore}}, {{/hasMore}}{{/allParams}})
    }

    {{#returnType}}
    val apiExecutionResultJson = Json.toJson(apiExecutionResult)
    Ok(apiExecutionResultJson)
    {{/returnType}}
    {{^returnType}}
    Ok
    {{/returnType}}
  }{{#hasMore}}

  {{/hasMore}}
  {{/operation}}

}
{{/operations}}